<?php
namespace ZN\Components;

class InternalTable implements TableInterface
{
	//----------------------------------------------------------------------------------------------------
	//
	// Yazar      : Ozan UYKUN <ozanbote@windowslive.com> | <ozanbote@gmail.com>
	// Site       : www.zntr.net
	// Lisans     : The MIT License
	// Telif Hakkı: Copyright (c) 2012-2016, zntr.net
	//
	//----------------------------------------------------------------------------------------------------
	
	//----------------------------------------------------------------------------------------------------
	// Attr
	//----------------------------------------------------------------------------------------------------
	// 
	// @var array
	//
	//----------------------------------------------------------------------------------------------------
	protected $attr = [];
	
	//----------------------------------------------------------------------------------------------------
	// Table
	//----------------------------------------------------------------------------------------------------
	// 
	// @var string
	//
	//----------------------------------------------------------------------------------------------------
	protected $table;
	
	//----------------------------------------------------------------------------------------------------
	// Error Control
	//----------------------------------------------------------------------------------------------------
	// 
	// $error
	// $success
	//
	// error()
	// success()
	//
	//----------------------------------------------------------------------------------------------------
	use \ErrorControlTrait;
	
	//----------------------------------------------------------------------------------------------------
	// Call Method
	//----------------------------------------------------------------------------------------------------
	// 
	// __call()
	//
	//----------------------------------------------------------------------------------------------------
	use \CallUndefinedMethodTrait;
	
	//----------------------------------------------------------------------------------------------------
	// Designer Methods Başlangıç
	//----------------------------------------------------------------------------------------------------

	//----------------------------------------------------------------------------------------------------
	// Attr
	//----------------------------------------------------------------------------------------------------
	// 
	// @param array $attributes
	//
	//----------------------------------------------------------------------------------------------------
	public function attr($attributes = [])
	{
		\Errors::typeHint(['array' => $attributes]);
		
		foreach( $attributes as $att => $val )
		{
			$this->attr[$att] = $val; 
		}

		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Align
	//----------------------------------------------------------------------------------------------------
	// 
	// @param string $align
	//
	//----------------------------------------------------------------------------------------------------
	public function align($align = '')
	{
		\Errors::typeHint(['string' => $align]);
		
		if( ! empty($align) )
		{
			$this->attr['align'] = $align;	
		} 
		
		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Content
	//----------------------------------------------------------------------------------------------------
	// 
	// @param void
	//
	//----------------------------------------------------------------------------------------------------
	public function content(...$elements)
	{	
		$colNo = 1;
		$rowNo = 1;
		$table = '';
		$eol   = EOL;
		
		if( isset($elements[0][0]) && is_array($elements[0][0]))
		{
			$elements = $elements[0];	
		}
		
		foreach($elements as $key => $element)
		{
			$table .= $eol."\t".'<tr>'.$eol;
			
			if(is_array($element))foreach($element as $k => $v)
			{
				$val = $v;
				$attr = "";
				
				if(is_array($v))
				{
					$attr = \Html::attributes($v);
					$val = $k;
				}
				
				if( strpos($val, 'th:') === 0 )
				{
					$rowType = 'th';
					$val = substr($val, 3);
				}
				else
				{
					$rowType = 'td';
				}
				
				$table .= "\t\t".'<'.$rowType.$attr.'>'.$val.'</'.$rowType.'>'.$eol;	
				$colNo++;
			}
		
			$table .= "\t".'</tr>'.$eol;
			$rowNo++;
		}
		
		$this->table = $table;
		
		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Cell
	//----------------------------------------------------------------------------------------------------
	// 
	// @param numeric $spacing
	// @param numeric $padding
	//
	//----------------------------------------------------------------------------------------------------
	public function cell($spacing = 0, $padding = 0)
	{
		\Errors::typeHint(['numeric' => $spacing], ['numeric' => $padding]);

		if( ! empty($spacing) )
		{
			$this->attr['cellspacing'] = $spacing;
		} 
		if( ! empty($padding) ) 
		{
			$this->attr['cellpadding'] = $padding;
		}
		
		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Cell Spacing
	//----------------------------------------------------------------------------------------------------
	// 
	// @param numeric $spacing
	//
	//----------------------------------------------------------------------------------------------------
	public function cellSpacing($spacing = 0)
	{
		\Errors::typeHint(['numeric' => $spacing]);
		
		if( ! empty($spacing) ) 
		{
			$this->attr['cellspacing'] = $spacing;
		}
		
		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Cell Padding
	//----------------------------------------------------------------------------------------------------
	// 
	// @param numeric $padding
	//
	//----------------------------------------------------------------------------------------------------
	public function cellPadding($padding = 0)
	{
		\Errors::typeHint(['numeric' => $padding]);
		
		if( ! empty($padding) )
		{
			$this->attr['cellpadding'] = $padding;
		}

		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Border
	//----------------------------------------------------------------------------------------------------
	// 
	// @param numeric $border
	// @param string  $color
	//
	//----------------------------------------------------------------------------------------------------
	public function border($border = 0, $color = '')
	{
		\Errors::typeHint(['numeric' => $border], ['string' => $color]);
		
		if( ! empty($border) )
		{
			$this->attr['border']      = $border;
		}

		if( ! empty($color) )
		{
			$this->attr['bordercolor'] = $color;
		}
	
		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Border Size
	//----------------------------------------------------------------------------------------------------
	// 
	// @param numeric $border
	//
	//----------------------------------------------------------------------------------------------------
	public function borderSize($border = 0)
	{
		\Errors::typeHint(['numeric' => $border]);
		
		if( ! empty($border) )
		{
			$this->attr['border'] = $border;
		}

		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Border Color
	//----------------------------------------------------------------------------------------------------
	// 
	// @param string $color
	//
	//----------------------------------------------------------------------------------------------------
	public function borderColor($color = '')
	{
		\Errors::typeHint(['string' => $color]);

		if( ! empty($color) )
		{
			$this->attr['bordercolor'] = $color;
		}

		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Width
	//----------------------------------------------------------------------------------------------------
	// 
	// @param numeric $width
	//
	//----------------------------------------------------------------------------------------------------
	public function width($width = '')
	{
		\Errors::typeHint(['scalar' => $width]);
		
		if( ! empty($width) )
		{
			$this->attr['width'] = $width;
		}

		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Height
	//----------------------------------------------------------------------------------------------------
	// 
	// @param numeric $height
	//
	//----------------------------------------------------------------------------------------------------
	public function height($height = '')
	{
		\Errors::typeHint(['scalar' => $height]);
		
		if( ! empty($height) )
		{
			$this->attr['height'] = $height;
		}

		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Size
	//----------------------------------------------------------------------------------------------------
	// 
	// @param numeric $width
	// @param numeric $height
	//
	//----------------------------------------------------------------------------------------------------
	public function size($width = '', $height = '')
	{
		\Errors::typeHint(['scalar' => $width], ['scalar' => $height]);
		
		if( ! empty($width) )  
		{
			$this->attr['width']  = $width;
		}

		if( ! empty($height) )
		{
			$this->attr['height'] = $height;
		}

		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Css
	//----------------------------------------------------------------------------------------------------
	// 
	// @param string $css
	//
	//----------------------------------------------------------------------------------------------------
	public function css($css = '')
	{
		\Errors::typeHint(['string' => $css]);
		
		if( ! empty($css) )
		{
			$this->attr['class'] = $css;
		}

		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Style
	//----------------------------------------------------------------------------------------------------
	// 
	// @param array $attributes
	//
	//----------------------------------------------------------------------------------------------------
	public function style($_attributes = [])
	{
		$attribute = "";

		\Errors::typeHint(['array' => $_attributes]);
		
		if( is_array($_attributes) )
		{
			foreach($_attributes as $key => $values)
			{
				if( is_numeric($key) )
				{
					$key = $values;
				}
				
				$attribute .= ' '.$key.':'.$values.';';
			}	
		}
		
		$this->attr['style'] = $attribute;
		
		return $this;	
	}
	
	//----------------------------------------------------------------------------------------------------
	// Background
	//----------------------------------------------------------------------------------------------------
	// 
	// @param mixed $background
	//
	//----------------------------------------------------------------------------------------------------
	public function background($background = '')
	{
		\Errors::typeHint(['string' => $background]);
		
		if( ! empty($background) )
		{
			$this->attr['background'] = $background;
		}

		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Bg Color
	//----------------------------------------------------------------------------------------------------
	// 
	// @param string $bgColor
	//
	//----------------------------------------------------------------------------------------------------
	public function bgColor($bgColor = '')
	{
		\Errors::typeHint(['string' => $bgColor]);
		
		if( ! empty($bgColor) )
		{
			$this->attr['bgcolor'] = $bgColor;
		}
		
		return $this;
	}
	
	//----------------------------------------------------------------------------------------------------
	// Designer Methods Bitiş
	//----------------------------------------------------------------------------------------------------
	
	//----------------------------------------------------------------------------------------------------
	// Create Method Başlangıç
	//----------------------------------------------------------------------------------------------------

	public function create()
	{
		$table  = '<table'.\Html::attributes($this->attr).'>';
		$table .= $this->table;
		$table .= '</table>';
		
		if( ! empty($this->table)) $this->table = NULL;
		if( ! empty($this->attr))  $this->attr = [];
		
		return $table;
	}	
	
	//----------------------------------------------------------------------------------------------------
	// Create Method Bitiş
	//----------------------------------------------------------------------------------------------------
}