<?php namespace ZN\ImageProcessing;

use Image, CallController;

class InternalThumb extends CallController implements InternalThumbInterface
{
    //--------------------------------------------------------------------------------------------------------
    //
    // Author     : Ozan UYKUN <ozanbote@gmail.com>
    // Site       : www.znframework.com
    // License    : The MIT License
    // Copyright  : (c) 2012-2016, znframework.com
    //
    //--------------------------------------------------------------------------------------------------------

    //--------------------------------------------------------------------------------------------------------
    // Sets
    //--------------------------------------------------------------------------------------------------------
    //
    // @var array
    //
    //--------------------------------------------------------------------------------------------------------
    protected $sets;

    //--------------------------------------------------------------------------------------------------------
    // Path
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $file
    //
    //--------------------------------------------------------------------------------------------------------
    public function path(string $file) : InternalThumb
    {
        $this->sets['filePath'] = $file;

        return $this;
    }

    //--------------------------------------------------------------------------------------------------------
    // Quality
    //--------------------------------------------------------------------------------------------------------
    //
    // @param int $quality
    //
    //--------------------------------------------------------------------------------------------------------
    public function quality(int $quality) : InternalThumb
    {
        $this->sets['quality'] = $quality;

        return $this;
    }

    //--------------------------------------------------------------------------------------------------------
    // Crop
    //--------------------------------------------------------------------------------------------------------
    //
    // @param int $x
    // @param int $y
    //
    //--------------------------------------------------------------------------------------------------------
    public function crop(int $x, int $y) : InternalThumb
    {
        $this->sets['x'] = $x;
        $this->sets['y'] = $y;

        return $this;
    }

    //--------------------------------------------------------------------------------------------------------
    // Size
    //--------------------------------------------------------------------------------------------------------
    //
    // @param int $width
    // @param int $height
    //
    //--------------------------------------------------------------------------------------------------------
    public function size(int $width, int $height) : InternalThumb
    {
        $this->sets['width']  = $width;
        $this->sets['height'] = $height;

        return $this;
    }

    //--------------------------------------------------------------------------------------------------------
    // Resize
    //--------------------------------------------------------------------------------------------------------
    //
    // @param int $width
    // @param int $height
    //
    //--------------------------------------------------------------------------------------------------------
    public function resize(int $width, int $height) : InternalThumb
    {
        $this->sets['rewidth']  = $width;
        $this->sets['reheight'] = $height;

        return $this;
    }

    //--------------------------------------------------------------------------------------------------------
    // Prosize
    //--------------------------------------------------------------------------------------------------------
    //
    // @param int $width
    // @param int $height
    //
    //--------------------------------------------------------------------------------------------------------
    public function prosize(int $width, int $height) : InternalThumb
    {
        $this->sets['prowidth']  = $width;
        $this->sets['proheight'] = $height;

        return $this;
    }


    //--------------------------------------------------------------------------------------------------------
    // Create
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $path
    //
    //--------------------------------------------------------------------------------------------------------
    public function create(string $path = NULL) : string
    {
        if( isset($this->sets['filePath']) )
        {
            $path = $this->sets['filePath'];
        }

        return Image::thumb($path, $this->sets);
    }

    //--------------------------------------------------------------------------------------------------------
    // Prosize
    //--------------------------------------------------------------------------------------------------------
    //
    // @param int $width
    // @param int $height
    //
    //--------------------------------------------------------------------------------------------------------
    public function getProsize(int $width = 0, int $height = 0)
    {
        if( ! isset($this->sets['filePath']) )
        {
            return false;
        }

        return Image::getProsize($this->sets['filePath'], $width, $height);
    }
}
