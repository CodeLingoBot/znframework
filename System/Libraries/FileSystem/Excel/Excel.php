<?php
class __USE_STATIC_ACCESS__Excel implements ExcelInterface
{
	//----------------------------------------------------------------------------------------------------
	//
	// Yazar      : Ozan UYKUN <ozanbote@windowslive.com> | <ozanbote@gmail.com>
	// Site       : www.zntr.net
	// Lisans     : The MIT License
	// Telif HakkÄ±: Copyright (c) 2012-2016, zntr.net
	//
	//----------------------------------------------------------------------------------------------------
	
	//----------------------------------------------------------------------------------------------------
	// Call Method
	//----------------------------------------------------------------------------------------------------
	// 
	// __call()
	//
	//----------------------------------------------------------------------------------------------------
	use CallUndefinedMethodTrait;
	
	//----------------------------------------------------------------------------------------------------
	// Output
	//----------------------------------------------------------------------------------------------------
	//
	// @param array  $rows
	//
	//----------------------------------------------------------------------------------------------------
	public function rows($rows = array())
	{
		$this->rows = $rows;
		
		return $this;	
	}
	
	//----------------------------------------------------------------------------------------------------
	// fileName
	//----------------------------------------------------------------------------------------------------
	//
	// @param string $fileName
	//
	//----------------------------------------------------------------------------------------------------
	public function fileName($fileName = '')
	{
		$this->fileName = suffix($fileName, '.xls');
		
		return $this;	
	}
	
	//----------------------------------------------------------------------------------------------------
	// Output
	//----------------------------------------------------------------------------------------------------
	//
	// @param array  $data
	// @param string $file
	//
	//----------------------------------------------------------------------------------------------------
	public function output($data = array(), $file = 'excel.xls')
	{
		if( ! empty($this->fileName) )
		{
			$file = $this->fileName;	
		}
		
		header("Content-Disposition: attachment; filename=\"$file\"");
		header("Content-Type: application/vnd.ms-excel;");
		header("Pragma: no-cache");
		header("Expires: 0");
		
		if( ! empty($this->rows) )
		{
			$data = $this->rows;	
		}
		
		$output = fopen("php://output", 'w');
		
		foreach( $data as $column )
		{
			fputcsv($output, $column,"\t");
		}
		
		fclose($output);
	}
}