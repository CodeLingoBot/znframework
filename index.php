<?php
/******************************************************************\
|                                                                  | 
|                          ZN FRAMEWORK                            |
|                                                                  |
*******************************************************************/

/*
	YAZAR: OZAN UYKUN
	
	1-COPYRIGHT(C) OZAN UYKUN
	2-TÜM HAKLARI SAKLIDIR.
	3-EMEGE SAYGI
*/

/* 
	SİSTEM ÇALIŞTIRMA MODLARI
	
	1-development
	2-publication 
	
	Varsayılan: development
*/

/* SYSTEM RUN *
 *
 * 
 * Sistem çalıştırılıyor...
 */
System::run('local'); // local, development veya publication.

/* SYSTEM SINIFI *
 *
 * 
 * 
 */
class System
{
	public static function run($apptype)
	{	
		//------------------------------------------------------------------
		//  Uygulama Dizini
		//------------------------------------------------------------------
		define('APP_DIR', 'Application/');
		//------------------------------------------------------------------
		
		//------------------------------------------------------------------
		//  Uygulama Türü
		//------------------------------------------------------------------
		define('APP_TYPE', $apptype);
		//------------------------------------------------------------------
		
		//------------------------------------------------------------------
		// Kullanılabilir Uygulama Seçenekleri
		//------------------------------------------------------------------
		switch( APP_TYPE )
		{ 
			//------------------------------------------------------------------
			// Publication Yayın Modu
			// Tüm hatalar kapalıdır.
			// Projenin tamamlanmasından sonra bu modun kullanılması önerilir.
			//------------------------------------------------------------------
			case 'publication' :
				error_reporting(0); 
			break;
			//------------------------------------------------------------------
			
			//------------------------------------------------------------------
			// Local Yerel Mod
			// Standart PHP hata çıktısı kapatılır. Bunun yerine
			// hatalar özel bir çıktı ile gösterilir.
			//------------------------------------------------------------------
			case 'local' :
			//------------------------------------------------------------------
			// Development Geliştirme Modu
			// Tüm hatalar açıktır.
			//------------------------------------------------------------------
			case 'development' : 
				error_reporting(-1);
			break; 
			//------------------------------------------------------------------
			
			//------------------------------------------------------------------
			// Farklı bir kullanım hatası
			//------------------------------------------------------------------
			default: echo 'Invalid Application Environment! Available Options: local, development or publication'; exit;
			//------------------------------------------------------------------
		}	
		//------------------------------------------------------------------
		
		/******************************************************************\
		|                                                                  | 
		|                SİSTEM BENCHMARK PERFORMANS TESTİ                 |
		|                                                                  |
		*******************************************************************/
		
		//------------------------------------------------------------------
		//------------------------------------------------------------------
		//------------------------------------------------------------------
		//------------------------------------------------------------------
		//  Sistem Performans Testini Başlat: true or false
		//------------------------------------------------------------------	
		$BENCHMARK_PERFOMANCE_TEST_START = false;	
		//------------------------------------------------------------------
		//------------------------------------------------------------------
		//------------------------------------------------------------------
		//------------------------------------------------------------------
		
		if( $BENCHMARK_PERFOMANCE_TEST_START === true ) 
		{
			//------------------------------------------------------------------
			//  Sisteminin Açılış Zamanını Hesaplamayı Başlat
			//------------------------------------------------------------------
			$start = microtime();
			//------------------------------------------------------------------
		}
		
		//******************************************************************
		//  Sistem yükleniyor ... >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		//
		require_once 'System/Core/Hierarchy.php'; // <<<<<<<<<<<<<<<<<<<<<<<
		//
		//  Sistem çalıştırılıyor ... >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		//******************************************************************
		
		if( $BENCHMARK_PERFOMANCE_TEST_START === true )
		{	
			//------------------------------------------------------------------
			//  Sistemin Açılış Zamanını Hesaplamayı Bitir
			//------------------------------------------------------------------
			$finish 		  = microtime();
			//------------------------------------------------------------------
			
			//------------------------------------------------------------------
			//  System Elapsed Time Calculating
			//------------------------------------------------------------------
			$elapsedTime     = $finish - $start;
			//------------------------------------------------------------------
			
			//------------------------------------------------------------------
			//  Sistemin Bellek Kullanımını Hesapla
			//------------------------------------------------------------------
			$memoryUsage 	  = memory_get_usage();
			//------------------------------------------------------------------
			
			//------------------------------------------------------------------
			//  Sistemin Maksimum Bellek Kullanımını Hesapla
			//------------------------------------------------------------------
			$maxMemoryUsage = memory_get_peak_usage();
			//------------------------------------------------------------------
			
			//------------------------------------------------------------------
			//  Benchmark Performans Sonuç Tablosu
			//------------------------------------------------------------------
			$style = '
				top:50%;
				left:50%;
				margin-left:-250px;
				margin-top:-70px;
				border:solid 1px #E1E4E5;
				background:#F3F6F6;
				padding:20px 20px 20px 20px;
				font-family:monospace, Tahoma, Arial;
				color:#333;
				width:500px;
				text-align:center;
				position:absolute;
			';
			
			$exStyle = 'color:#900;';
		
			$benchResult     = "
			<div style='$style'>
			<div style='$exStyle'>".lang('Benchmark', 'resultTable')."</div>
			<p></p>
			<div>
			".lang('Benchmark', 'elapsedTime', "<b>$elapsedTime</b>")."<br>                       
			".lang('Benchmark', 'memoryUsage', "<b>$memoryUsage</b>")."<br>                     
			".lang('Benchmark', 'maxMemoryUsage', "<b>$maxMemoryUsage</b>")."<br>       
			<div>
			</div>
			";
			//------------------------------------------------------------------
			
			//------------------------------------------------------------------
			//  Benchmark Performans Sonuç Tablosu Yazdırılıyor
			//------------------------------------------------------------------
			echo $benchResult;
			//------------------------------------------------------------------
					
			//------------------------------------------------------------------
			//  Sistem benchmark performans test sonuçlarını raporla.
			//------------------------------------------------------------------
			report('BenchmarkTestResults', $benchResult, 'BenchmarkTestResults');
			//------------------------------------------------------------------
		}
	}
}